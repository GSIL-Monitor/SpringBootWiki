<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      layout:decorate="layouts/base">

<head>
</head>
<body class="smoothscroll enable-animation">

<div layout:fragment="content">

    <div class="container">
        <div class="row-fluid row-intro">
            <div class="span12">
                <h3>Jquery Table Usage Show</h3>
                <p>The following table uses the default configuration.</p>
                <p>Open your browser debugger and take a look at the generated parameters!</p>
            </div>
        </div>

        <div class="row-fluid">
            <div class="span12">

                <table id="myTableId" class="table table-striped table-bordered table-hover" >
                    <thead>
                    <tr>
                        <th>id</th>
                        <th>lastName</th>
                        <th>firstName</th>
                        <th>City</th>
                        <th>Mail</th>
                        <th>Salary</th>
                        <th>Birthdate</th>
                        <th>Company</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="person : ${persons}">
                        <td th:text="${person?.id}">1</td>
                        <td th:text="${person?.lastName}">Doe</td>
                        <td th:text="${person?.firstName}">John</td>
                        <td th:text="${person?.address?.town?.name}">Nobody knows!</td>
                        <td th:text="${person?.mail}">john@doe.com</td>
                        <td th:text="${person?.salary}">&euro;1000</td>
                        <td th:text="${#dates.format(person?.birthDate, 'dd-MM-yyyy')}">23-10-1980</td>
                        <td th:text="${person?.company?.name}">Amazon</td>
                    </tr>
                    </tbody>
                </table>

            </div>
        </div>
    </div>

    <!-- CSS DATATABLES -->
    <link href="/ui/smarty/css/layout-datatables.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="/ui/smarty/plugins/datatables/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="/ui/smarty/plugins/datatables/js/dataTables.tableTools.min.js"></script>
    <script type="text/javascript" src="/ui/smarty/plugins/datatables/js/dataTables.colReorder.min.js"></script>
    <script type="text/javascript" src="/ui/smarty/plugins/datatables/js/dataTables.scroller.min.js"></script>
    <script type="text/javascript" src="/ui/smarty/plugins/datatables/dataTables.bootstrap.js"></script>
    <script type="text/javascript" src="/ui/smarty/plugins/select2/js/select2.full.min.js"></script>
    <script th:inline="javascript">
        /*<![CDATA[*/

        function initTable2() {
            var table = jQuery('#myTableId');

            $.extend(true, $.fn.DataTable.TableTools.classes, {
                "container": "btn-group tabletools-btn-group pull-right",
                "buttons": {
                    "normal": "btn btn-sm btn-default",
                    "disabled": "btn btn-sm btn-default disabled"
                }
            });

            var oTable = table.dataTable({
                "order": [
                    [0, 'asc']
                ],
                "lengthMenu": [
                    [5, 15, 20, -1],
                    [5, 15, 20, "All"] // change per page values here
                ],

                // set the initial value
//                "pageLength": 10,
                "dom": "<'row' <'col-md-12'T>><'row'<'col-md-6 col-sm-12'l><'col-md-6 col-sm-12'f>r><'table-scrollable't><'row'<'col-md-5 col-sm-12'i><'col-md-7 col-sm-12'p>>", // horizobtal scrollable datatable

                "tableTools": {
                    "sSwfPath": "/ui/smarty/plugins/datatables/extensions/TableTools/swf/copy_csv_xls_pdf.swf",
                    "aButtons": [{
                        "sExtends": "pdf",
                        "sButtonText": "PDF"
                    }, {
                        "sExtends": "csv",
                        "sButtonText": "CSV"
                    }, {
                        "sExtends": "xls",
                        "sButtonText": "Excel"
                    }, {
                        "sExtends": "print",
                        "sButtonText": "Print",
                        "sInfo": 'Please press "CTRL+P" to print or "ESC" to quit',
                        "sMessage": "Generated by DataTables"
                    }, {
                        "sExtends": "copy",
                        "sButtonText": "Copy"
                    }]
                },
                "processing": true,
                "serverSide": true,
                "searchDelay": 2000,
                "ajax": {
                    "url": "/dp4A",
//                    "dataSrc": function ( json ) {
//                        for ( var i=0, ien=json.data.length ; i<ien ; i++ ) {
////                            json.data[i][1] = '<a href="/message/'+json.data[i][1]+'>View message</a>';
//                            json.data[i][1] = 'CCCCCCCCCCCCC'+json.data[i][1]+'';
//                        }
//                        return json.data;
//                    }

                },
                "columns": [
                    { "data": "id" },
                    { "data": "lastName" },
                    { "data": "firstName" },
                    { "data": "address.town.name" },
                    { "data": "mail" },
                    { "data": "salary" },
                    { "data": "birthDate" },
                    {
                        "data": "company.name",
                        "render": function ( data, type, full, meta ) {
                            return '<a href="'+data+'">Download</a>';
                        }
                    }
                ]

            });

            var tableWrapper = jQuery('#myTableId_wrapper'); // datatable creates the table wrapper by adding with id {your_table_jd}_wrapper
            tableWrapper.find('#myTableId_length select').select2(); // initialize select2 dropdown
        }


        // Table Init
        initTable2();


        // Call datatables, and return the API to the variable for use in our code
        // Binds datatables to all elements with a class of datatable
        var dtable = $("#dataTable").dataTable().api();

        $("#myTableId_filter input")
                .unbind('keypress keyup change') // Unbind previous default bindings
                .bind('keypress keyup change', function (e) { // Bind our desired behavior
                    // If the length is 3 or more characters, or the user pressed ENTER, search
                    if (this.val().length >= 3 || e.keyCode == 13) {
                        // Call the API search function
                        dtable.search(this.value).draw();
                    }
                    // Ensure we clear the search if they backspace far enough
                    if (this.val() == "") {
                        dtable.search("").draw();
                    }
                    return;
                });
        /*]]>*/
    </script>

</div>



</body>
</html>